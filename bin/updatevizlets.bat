@rem copies binaries and other things from %VIZBENCH% to %VIZLETS%
@rem so it can be packaged up for distribution.

@if x%1 == x echo Usage: updatevizlets "{Debug|Release}"
@if x%1 == x goto getout:

@if x%VIZBENCH% == x echo You need to set VIZBENCH
@if x%VIZBENCH% == x goto getout:

@if x%VIZLETS% == x echo You need to set VIZLETS
@if x%VIZLETS% == x goto getout:

set config=%1

copy %VIZBENCH%\ffglplugins%config%\*.* %VIZLETS%\ffglplugins
copy %VIZBENCH%\bin%config%\FFFF.exe %VIZLETS%\bin
copy %VIZBENCH%\bin%config%\VizServer.dll %VIZLETS%\bin

rem Get rid of plugins that shouldn't be distributed
del %VIZLETS%\ffglplugins\VizLooper.dll
del %VIZLETS%\ffglplugins\VizletTemplate.dll

rem The python-based EXEs and library, no separate Release or Debug version
copy %VIZBENCH%\src\oscutil\dist\*.* %VIZLETS%\bin
copy %VIZBENCH%\src\jsonrpc\dist\*.* %VIZLETS%\bin

rem The library.zip in bin is generated by postpy2exe.bat
rem It's a combination of what's needed by oscutil and jsonrpc
copy %VIZBENCH%\bin\library.zip %VIZLETS%\bin

rem other DLLs
copy %VIZBENCH%\bin\pthreadVC2.dll %VIZLETS%\bin

copy %VIZBENCH%\bin\p.bat %VIZLETS%\bin
copy %VIZBENCH%\bin\mf.bat %VIZLETS%\bin
copy %VIZBENCH%\bin\api.bat %VIZLETS%\bin
copy %VIZBENCH%\bin\oscplayback.bat %VIZLETS%\bin
copy %VIZBENCH%\bin\osclisten.bat %VIZLETS%\bin

rem HTML
copy %VIZBENCH%\html\*.html %VIZLETS%\html
copy %VIZBENCH%\html\*.js %VIZLETS%\html

rem Params
copy %VIZBENCH%\config\params\*.json %VIZLETS%\config\params

rem copy %VIZBENCH%\bin\*.osc %VIZLETS%\bin

rem clean up temporary files
del /s %VIZLETS%\html\*~ 2> nul
del /s %VIZLETS%\bin\*~ 2> nul
del /s %VIZLETS%\config\*~ 2> nul
del /s %VIZLETS%\shaders\*~ 2> nul
del /s %VIZLETS%\params\*~ 2> nul

:getout
